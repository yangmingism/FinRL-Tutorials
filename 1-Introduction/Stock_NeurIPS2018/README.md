我们展示了在算法交易中应用 RL 的工作流程，它是对 [NeurIPS 2018 论文](https://arxiv.org/abs/1811.07522) 中流程的复制和改进。

# 使用

## 第一步。数据

首先，运行笔记本：*Stock_NeurIPS2018_1_Data.ipynb*。

它会下载和预处理股票的 OHLCV 数据。

它会生成两个 csv 文件：*train.csv*、*trade.csv*。你可以查看提供的两个示例文件。

欢迎使用你自己的数据。只需确保将数据框调整为正确的结构。

## 第二步。训练一个交易代理

其次，运行笔记本：*Stock_NeurIPS2018_2_Train.ipynb*。

它展示了如何将数据处理成 OpenAI gym 风格的环境，然后训练一个 DRL 代理。

它将生成一个训练好的 RL 模型 .zip 文件。在这里，我们还提供了一个训练好的 A2C 模型，压缩在 .zip 文件中。

## 第三步。回测

最后，运行笔记本：*Stock_NeurIPS2018_3_Backtest.ipynb*。

它会对训练好的代理进行回测，并分别与两个基准进行比较：均值方差优化和市场 DJIA 指数。

最后，它会绘制回测过程中投资组合价值的图表。
